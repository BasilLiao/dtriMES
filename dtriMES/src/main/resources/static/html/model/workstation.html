<!-- 工作站模式 -->
<style>
	.over_hid {
		overflow: hidden;
		text-overflow: ellipsis;
	}

	.big-checkbox {
		width: 20px;
		height: 20px;
	}

	#barcode_sn_name .package_qty {
		font-size: 18px;
	}

	.b_code_w {
		max-width: 180px;
	}

	.fix_t_css,
	.fix_i_css {
		white-space: nowrap;
		overflow: hidden;
		font-size: 14px;
		line-height: 15px;
	}
</style>
<div id="workstation" class="text-left shadow">
	<div class=" bg-white rounded-top m-0 pl-1 h5">
		<i class="bi bi-joystick mr-1"></i>Workstation->
		<!--  -->
		<b class="h6" id="workdatation_program_name">Loading...</b> / (
		<!--  -->
		<b class="h6" id="workdatation_sort">Loading...</b> :
		<!--  -->
		<b class="h6" id="workstation_name">Loading...</b>)
	</div>
	<div class="p-2">
		<form onsubmit="return workstation.send_command();">
			<table class="table table-sm  table-bordered table-responsive m-0 bg-white" style="min-height: 60vh">
				<thead class="thead bg-dark table-dark">
					<tr>
						<th style="min-width: 35px;" class="text-center">
							<div>
								<i id="barcode_open" class="bi bi-upc-scan btn btn-outline-light p-0 pl-1 pr-1"></i>
							</div>
						</th>
						<th style="min-width: 10px;">
							<div id="barcode_status" class="barcode_open" style="display: none;">
								<div style="min-width: 80px;">Barcode</div>
							</div>
						</th>
						<th class="">
							<div>
								<i id="fix_open" class="bi bi-tools btn btn-outline-warning p-0 pl-1 pr-1"></i>
							</div>
						</th>
						<th style="min-width: 10px;">
							<div id="" class="fix_open" style="display: none;">
								<div style="min-width: 300px;">Fix</div>
							</div>
						</th>
						<th style="min-width: 35px;">
							<div>
								<i class="bi bi-shield-slash btn btn-outline-danger p-0 pl-1 pr-1 d-none"></i>
							</div>
							<div>
								<i class="bi bi-shield-lock btn btn-outline-success p-0 pl-1 pr-1"></i>
							</div>
						</th>
						<th style="min-width: 440px; width: 100%;">Info</th>
						<th style="min-width: 35px;" class="text-center">
							<div>
								<i id="doc_open"
									class="bi bi-layout-text-sidebar-reverse btn btn-outline-primary p-0 pl-1 pr-1"></i>
							</div>
						</th>
						<th style="min-width: 10px;">
							<div id="doc_status" class="doc_open" style="display: none;">
								<div style="min-width: 380px;">Doc</div>
							</div>
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<!-- fix -->
						<td colspan="8" class="p-0 border border-dark">
							<div class="row justify-content-between m-0">
								<div class="row m-0 p-2">
									<div id="barcode_BC008" class="m-1"></div>
									<div>功能代碼[BC008]</div>
								</div>
								<div class="row m-0 p-2">
									<div id="barcode_BC009" class="m-1"></div>
									<div>故障代碼[BC009]</div>
								</div>
								<div class="row m-0 p-2">
									<div id="barcode_BC010" class="m-1"></div>
									<div>資訊內容[BC010]</div>
								</div>
							</div>
						</td>
					</tr>
					<tr id="barcode_action" class="font-weight-bold">
						<!-- 動作機制 -->
						<td colspan="2" rowspan="100" class="p-0 pl-1 pr-1  text-center small border-dark border">
							<div class="barcode_open" style="display: none;">
								<div class="p-2" id="previous">
									<div id="barcode_BC001"></div>
									<div id="BC001" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											previous(上)<br>[BC001]
										</div>
									</div>
								</div>
								<div class="p-2" id="next">
									<div id="barcode_BC002"></div>
									<div id="BC002" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											next(下)<br>[BC002]
										</div>
									</div>
								</div>
								<div class="dropdown-divider p-0 mt-2"></div>
								<div class="p-2" id="check">
									<div id="barcode_BC003"></div>
									<div id="BC003" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											check(檢查/刷新)<br>[BC003]
										</div>
									</div>
								</div>
								<div class="p-2" id="save">
									<div id="barcode_BC004"></div>
									<div id="BC004" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											save(儲存)<br>[BC004]
										</div>
									</div>
								</div>
								<div class="p-2" id="check_work_end">
									<div id="barcode_BC015"></div>
									<div id="BC015" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											save(結束製令單)<br>[BC015]
										</div>
									</div>
								</div>
								<div class="dropdown-divider p-0 mt-2"></div>
								<div class="p-2" id="save">
									<div id="barcode_BC011"></div>
									<div id="BC011" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											print(伺服器 打印)<br>[BC011]
										</div>
									</div>
								</div>
								<!--<div class="p-2" id="save">
									<div id="barcode_BC012"></div>
									<div id="BC012" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											print(印出包裝PG)<br>[BC012]
										</div>
									</div>
								</div>-->
								<div class="p-2" id="save">
									<div id="barcode_BC023"></div>
									<div id="BC023" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											print(清除包裝)<br>[BC023]
										</div>
									</div>
								</div>
								<div class="dropdown-divider p-0 mt-2"></div>
								<div class="p-2" id="clear">
									<div id="barcode_BC005"></div>
									<div id="BC005" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											clear(清除)<br>[BC005]
										</div>
									</div>
								</div>
								<div class="p-2" id="cancel">
									<div id="barcode_BC006"></div>
									<div id="BC006" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											all cancel(取消)<br>[BC006]
										</div>
									</div>
								</div>
								<div class="dropdown-divider p-0 mt-2"></div>
								<div class="p-2" id="logout">
									<div id="barcode_BC020"></div>
									<div id="BC020" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											check mode<br>(檢查模式)[BC020]
										</div>
									</div>
								</div>
								<div class="p-2" id="logout">
									<div id="barcode_BC021"></div>
									<div id="BC021" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											general mode<br>(一般模式)[BC021]
										</div>
									</div>
								</div>
								<div class="p-2" id="logout">
									<div id="barcode_BC022"></div>
									<div id="BC022" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											PLT mode<br>(PLT模式)[BC022]
										</div>
									</div>
								</div>

								<div class="dropdown-divider p-0 mt-2"></div>
								<div class="p-2" id="logout">
									<div id="barcode_BC007"></div>
									<div id="BC007" class="btn btn-sm btn-light col-12 p-0 m-0 mt-1 barcode_action">
										<div class="small font-weight-bold">
											logout(登出)<br>[BC007]
										</div>
									</div>
								</div>
							</div>
						</td>
						<td colspan="2" rowspan="100" class="p-1 border-warning border">
							<!-- 維修條碼_類型(浮動) -->
							<div id="fix_t_open"
								class="col-12 row justify-content-start m-0 text-center p-0 border border-secondary rounded"
								style="display: none; height: 290px; overflow: auto;">
								<!-- 浮動上下 -->
								<div class="bg-white fixed-top shadow border border-primary rounded "
									style="top: 32%; left: auto; right: 35px; width: 140px;">
									<div class="col-12 p-1">
										<div class="row m-0 p-1 bg-light">
											<div id="barcode_BC016" class="m-0 col-lg-12"></div>
											<div id="BC016" class="barcode_action btn btn-light p-0 border-0 pt-1">
												[BC016]類別_U8</div>
										</div>
									</div>
									<div class="col-12 p-1">
										<div class="row m-0 p-1 bg-light">
											<div id="barcode_BC017" class="m-0 col-lg-12"></div>
											<div id="BC017" class="barcode_action btn btn-light p-0 border-0 pt-1">
												[BC017]類別_D8</div>
										</div>
									</div>
									<div class="dropdown-divider p-0 mt-2"></div>
									<div class="col-12 p-1">
										<div class="row m-0 p-1 bg-light">
											<div id="barcode_BC018" class="m-0 col-lg-12"></div>
											<div id="BC018" class="barcode_action btn btn-light p-0 border-0 pt-1">
												[BC018]項目_U8</div>
										</div>
									</div>
									<div class="col-12 p-1">
										<div class="row m-0 p-1 bg-light">
											<div id="barcode_BC019" class="m-0 col-lg-12"></div>
											<div id="BC019" class="barcode_action btn btn-light p-0 border-0 pt-1">
												[BC019]項目_D8</div>
										</div>
									</div>
								</div>

								<div class="row col-12 p-0 m-0">
									<div class="col-12 m-0 p-1 h4" style="height: 56px;">故障類別</div>
								</div>
								<div id="fix_t_example" class="p-1 col-6">
									<div class="row m-0 p-1 bg-light">
										<div id="barcode_BC013" class="m-0 pl-4 col-12"></div>
										<div id="BC013" title=""
											class="fix_t_css barcode_action btn btn-light p-0 border-0 pt-1 font-weight-bold">
											XXX[BC013]</div>
									</div>
								</div>
							</div> <!-- 維修條碼_項目(浮動) -->
							<div id="fix_i_open"
								class="col-12 row justify-content-start m-0 text-center p-0 border border-secondary rounded"
								style="display: none; height: 305px; overflow: auto;">
								<div class="col-12 row m-0 p-0">
									<div class="col-12 m-0 p-1 h4" style="height: 56px;">
										代碼:<i id="fix-item"></i>
									</div>
								</div>

								<div id="fix_i_example" class="p-1 col-6">
									<div class="row m-0 p-1 bg-light">
										<div id="barcode_BC014" class="m-0 pl-4 col-12"></div>
										<div id="BC014" title=""
											class="barcode_action fix_i_css btn btn-light p-0 border-0 pt-1 pb-1 font-weight-bold">
											XXX[BC014]</div>
										<textarea id="fix_i_textarea" rows="2" cols=""
											class="p-1 col-12 d-none"></textarea>
										<div id="fix_i_ex" class="m-0 p-0 col-12 text-left d-none">
											<div>可能[故障碼]:</div>
											<div id="fix_i_ex_value" class="bg-white" style="min-height: 100px;"></div>
										</div>
									</div>
								</div>
							</div>
							<div id="use_explain"
								class="col-12 row justify-content-start m-0 text-center p-0 border border-secondary rounded"
								style="display: none; height: 160px; overflow: auto;">
								<div class="col-12 row m-0 p-0 border border-dark rounded">
									<div class="col-12 m-0 p-1 h4" style="height: 36px;">快捷說明</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">Ctrl + ↑ : 往上移動</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">Ctrl + ↓ : 往下移動</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">Ctrl + → : 檢查資訊</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">Ctrl + ← : 清除欄位</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">Ctrl + Enter : 返回輸入</div>
								</div>
								<div class="col-12 row m-0 p-0 border border-dark rounded">
									<div class="col-12 m-0 p-1 h4" style="height: 36px;">Barcode說明</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">[3X1AUTO] : 3X1 [自動]</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">[3X1EXCLUDE] : 3X1 [排除]</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">[3X1PART] : 3X1 [Part No]</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">[3X1PCODE] : 3X1 [P code]</div>
									<div class="col-12 m-0 p-1 h6" style="height: 30px;">[3X1PQTY] : 3X1 [P qty]</div>
								</div>
							</div>
						</td>
						<td colspan="3" class="p-0">
							<!-- 必要性框架隔板 -->
						</td>
						<!-- Doc -->
						<td colspan="2" class="p-1 border border-primary" rowspan="100">
							<!-- (固定)顯特定內容 -->
							<div class="doc_open" style="display: none;">
								<div id="" style="min-width: 380px;">
									<!-- (固定)顯特定內容 (製令資訊/軟體定義/規格定義)-->
									<div id="doc_c_x" class="border border-secondary rounded">
										<div id="" class="p-1 col-6 doc_t_name ">Information</div>
										<div id="doc_all" class="p-0 row m-0">
											<div id="doc_example" class="col-6 p-0 d-none">
												<div class="m-0 p-1">
													<div class="row m-0">
														<input
															class="col-2 mt-1 p-1 border border-dark rounded big-checkbox doc_c_check"
															id="" name="" value="true" type="checkbox"
															style="max-width: 30px;">
														<div class="col-10 doc_c_name p-0 over_hid" id=""
															contenteditable="true">Loading...</div>
													</div>
													<input disabled="disabled"
														class="col-12  p-0 border border-light rounded doc_c_value"
														id="" type="text" required>
													<textarea disabled="disabled"
														class="col-12  p-0 border border-light rounded doc_c_value d-none"
														id="" rows="5" required
														style="word-break: break-all;"></textarea>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_user" class="w_i_0 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class="row p-1 m-0 border  border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">*作業人(s):</div>
								<div class="col-9 p-0">
									<input title="w_c_us_name" id="w_focus_0" disabled="disabled"
										class="w_sn_value col p-1 border-1 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1 border border-dark border-bottom-0">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_work" class="w_i_1 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class="row p-1 m-0 border  border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">*工作站:</div>
								<div class="col-9 p-0">
									<input title="w_c_name" id="w_focus_1" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_order" class="w_i_2 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">*製令單號:</div>
								<div class="col-9 p-0">
									<input title="ph_pr_id" id="w_focus_2" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_path" class="w_i_3 font-weight-bold">
						<td colspan="2" class="p-0 ">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">產品位置:</div>
								<div class="col-9 p-0">
									<input title="pb_position" id="w_focus_3" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_fix" class="w_i_4 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">故障代碼:</div>
								<div class="col-9 p-0">
									<input title="pb_f_value" id="w_focus_4" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!--(固定) -->
					<tr id="barcode_sn" class="w_i_5 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">*產品序號:</div>
								<div class="col-9 p-0">
									<input title="pb_b_sn" id="w_focus_5" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>

					<tr id="barcode_old_sn" class="w_i_6 font-weight-bold d-none">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-3 p-1 m-0 b_code_w">[舊]產品序號:</div>
								<div class="col-9 p-0">
									<input title="pb_old_sn" id="w_focus_6" disabled="disabled"
										class="w_sn_value col p-1 border-0 border-primary rounded" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3 d-none"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 "></i>
							</div>
						</td>
					</tr>
					<tr class="font-weight-bold">
						<td colspan="3" class="pr-0 pl-0">
							<div class="dropdown-divider p-0 m-0 border border-dark"></div>
						</td>
					</tr>
					<!--(固定)目前條碼 -->
					<tr class="font-weight-bold">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded h2">
								<div class="col-3 p-1 m-0 b_code_w ">
									<div class="font-weight-bold">輸入:</div>
								</div>
								<div class="col-6 p-0">
									<input autocomplete="off" class="col p-1 rounded" id="m_order" type="text" required
										autofocus>
								</div>
								<div class="col-3 pr-0">
									<button id="send_command_btn" class="col-12 m-0 p-2 btn btn-primary btn-sm"
										type="submit">Send Command</button>
								</div>
							</div>
						</td>
						<!-- 鎖定 -->
						<td class="p-1">
							<div>
								<i class="bi bi-shield-check text-success p-0 h3"></i>
							</div>
							<div>
								<i class="bi bi-shield-exclamation text-warning p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<tr id="title_sn" class="d-none">
						<td colspan="2" class="p-0 m-0">
							<div class=" row p-1 m-0 border border-light rounded h2">
								<div class="h6 col-4 p-0 m-0 pl-2 font-weight-bold b_code_w" style="font-size: 14px;">
									指定[列印]勾選</div>
								<div class="h6 col-8 p-0 m-0 pl-2 font-weight-bold" style="font-size: 14px;">登記[序號]料件
								</div>
							</div>
						</td>
						<td>
						<td class="p-1">
					</tr>
					<tr id="sn_example" class="font-weight-bold">
						<td colspan="3" class="pr-0 pl-0">
							<div class="dropdown-divider p-0 m-0 border border-dark"></div>
						</td>
					</tr>
					<!-- 工作項目(浮動) Manufacturing order-->
					<tr id="workstation_example" class="w_i_6 font-weight-bold">
						<td colspan="2" class="p-0">
							<div class=" row p-1 m-0 border border-light rounded">
								<div class="col-4 p-0 row m-0 b_code_w">
									<input class="ml-1 mt-2 p-1 border border-dark rounded big-checkbox w_sn_check"
										id="" name="" value="true" type="checkbox">
									<div class=" m-0 p-1 w_sn_name" contenteditable="true">Loading...</div>
								</div>
								<div class="col-8 p-0">
									<input id="" class="w_sn_value col p-1 border-0 border-primary rounded"
										disabled="disabled" type="text" required>
								</div>
							</div>
						</td>
						<td class="p-1">
							<div class="w_i_success">
								<i class="bi bi-shield-check text-success p-0 h3 d-none"></i>
							</div>
							<div class="w_i_warning">
								<i class="bi bi-shield-exclamation text-warning p-0 h3"></i>
							</div>
							<div class="w_i_danger">
								<i class="bi bi-shield-x text-danger p-0 h3 d-none"></i>
							</div>
						</td>
					</tr>
					<!-- 功能(固定) -->
					<tr>
						<td colspan="3" class="p-0 border border-light ">
							<div class="shadow-sm text-left">
								<div class=" bg-white rounded-top m-0 pl-1 h5">
									<i class="bi bi-file-earmark-check mr-1"></i> Action/Options
								</div>
								<div class="col-12 p-1 m-0 row justify-content-center">
									<div class="col-sm-3 p-1">
										<div
											class="row pl-1 m-0 font-weight-bold border rounded border-primary pb-1 mb-1">
											<div class="p-0 pl-1">[PLT]設定</div>
											<div class="col-12 row p-0 m-0" id="checkbox_plt">
												<div class="row p-0 m-0 col-12">
													<div class="p-0 pl-1">檢查 :</div>
													<input class="mt-1 ml-1 p-1 rounded big-checkbox" id="plt_check"
														name="" value="true" type="checkbox" style="max-width: 30px;">
												</div>
												<div class="row p-0 m-0 col-12">
													<div class="p-0 pl-1">儲存 :</div>
													<input class="mt-1 ml-1 p-1 rounded big-checkbox" id="plt_save"
														name="" value="true" type="checkbox" style="max-width: 30px;">
												</div>
												<div class="row p-0 m-0 col-12">
													<div class="p-0 pl-1">歸檔 :</div>
													<input class="mt-1 ml-1 p-1  rounded big-checkbox"
														id="plt_file_classify" name="" value="true" type="checkbox"
														style="max-width: 30px;">
												</div>
											</div>
										</div>
									</div>
									<div class="col-sm-3 p-1">
										<div
											class="row pl-1 m-0 font-weight-bold border rounded border-primary pb-1 mb-1">
											<div class="p-0 pl-1">[保留]設定</div>
											<div class="col-12 row p-0 m-0" id="checkbox_only">
												<div class="p-0">唯讀SN :</div>
												<input class="mt-1 ml-1 p-1 rounded big-checkbox" id="only_check"
													name="" value="true" type="checkbox" style="max-width: 30px;">
											</div>
										</div>
										<div
											class="row pl-1 m-0 font-weight-bold border rounded border-primary pb-1 mb-1">
											<div class="p-0 pl-1">[功能]設定</div>
											<div class="col-12 row p-0 m-0" id="checkbox_only_one_pass">
												<div class="p-0">僅一次過站 :</div>
												<input class="mt-1 ml-1 p-1 rounded big-checkbox" id="only_one_pass"
													checked="checked" name="" value="true" type="checkbox"
													style="max-width: 30px;">
											</div>
											<div class="col-12 row p-0 m-0" id="checkbox_remember_printer_set">
												<div class="p-0">記憶標籤設定 :</div>
												<input class="mt-1 ml-1 p-1 rounded big-checkbox"
													id="remember_printer_set" name="" value="true" type="checkbox"
													style="max-width: 30px;">
											</div>
										</div>
									</div>

									<div class="col-sm-3 p-1">
										<div
											class="row pl-1 m-0 font-weight-bold border rounded border-primary pb-1 mb-1">
											<div class="col-12 p-0">[產品序號]輸入後</div>
											<div class="col-12 p-0 m-0" id="checkbox_auto">
												<div class="row p-0 m-0 col-12">
													<div class="p-0">Auto 儲存 :</div>
													<input class="mt-1 ml-1 p-1 rounded big-checkbox" id="after_sn_save"
														name="" value="true" type="checkbox" style="max-width: 30px;">
												</div>
												<div class="row p-0 m-0 col-12">
													<div class="p-0">Auto 檢查 :</div>
													<input class="mt-1 ml-1 p-1 rounded big-checkbox"
														id="after_sn_check" checked="checked" name="" value="true"
														type="checkbox" style="max-width: 30px;">
												</div>
											</div>
										</div>
									</div>

									<div class="col-sm-3 p-1">
										<div
											class="row pl-1 m-0 font-weight-bold border rounded border-primary pb-1 mb-1">
											<div class="col-12 p-0">[聲效]特效</div>
											<div class="col-12 p-0 m-0" id="checkbox_sound">
												<div class="row p-0 m-0 col-12">
													<div class="p-0">重複過站:</div>
													<input id="set_replace" value="true" type="checkbox"
														checked="checked"
														class="col-2 mt-1 p-1 border border-dark rounded big-checkbox"
														style="max-width: 30px;">
												</div>
												<div class="row p-0 m-0 col-12">
													<div class="p-0">提醒過站:</div>
													<input id="set_success" value="true" type="checkbox"
														checked="checked"
														class="col-2 mt-1 p-1 border border-dark rounded big-checkbox"
														style="max-width: 30px;">
												</div>
												<div class="row p-0 m-0 col-12">
													<div class="p-0">重複檢查:</div>
													<input id="set_check_replace" value="true" type="checkbox"
														class="col-2 mt-1 p-1 border border-dark rounded big-checkbox"
														style="max-width: 30px;">
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</td>
					</tr>
					<!-- 累計Cumulative SN(固定) -->
					<tr class="font-weight-bold">
						<td colspan="3" class="pr-0 pl-0">
							<div class="dropdown-divider p-0 m-0 border border-dark"></div>
						</td>
					</tr>
					<tr>
						<td rowspan="2" colspan="3" class="p-0 border border-dark">
							<!-- 標籤樣式(動態) -->
							<div class="shadow-sm text-left" style="min-height: 400px;">
								<div class=" bg-dark text-light m-0 p-1 h5">
									<i class="bi bi-upc-scan mr-1"></i> Print Barcode (Auto) For : <b
										id="label_pr_id"></b><b id="label_group"></b>
								</div>
								<div id="label_list" class="row m-0" style="max-height: 470px;overflow: auto;">
									<!-- 範例標籤 -->
									<div id="ex_label_hr" class="p-0 m-0 col-12 text-center d-none h6"></div>
									<div id="ex_label_id" class="d-none m-1" style="width: 245px;">
										<div class="row p-0 m-1 justify-content-end border border-primary rounded-top">
											<div class="label_name h5 col-10 m-0 p-1">Ex範例標籤</div>
											<div id="ex_label_op" class="col-2 pn__op p-1 pt-1">
												<i
													class="bi bi-plus-square btn btn-outline-success p-0 pl-1 pr-1 m-0"></i>
											</div>
											<div id="ex_label_cl" class="col-2 pn__cl p-1 pt-1 d-none">
												<i
													class="bi bi-dash-square btn btn-outline-danger p-0 pl-1 pr-1 m-0"></i>
											</div>
										</div>
										<div id="ex_label" class="d-none p-0 m-1 border border-dark">
											<div class="row m-0 pl-1 h5">
												<div class="col-1 m-0 p-0">
													<input name="" value="true" type="checkbox"
														class="label_auto mt-1 border border-dark rounded big-checkbox">
												</div>
												<div class="col-11 m-0 p-0">選擇標籤(自動)</div>
											</div>
											<div class="printer_c p-1 m-0 mb-2 row bg-light">
												<div class="col-6 m-0 p-1">Printer(標籤機)</div>
												<div class="col-6 m-0 p-1">
													<input placeholder="標籤機代號" type="text" class="col p-0 rounded"
														value="">
												</div>
											</div>
											<div class="barcode_print_q p-1 m-0 mb-2 row bg-light">
												<div class="col-8 m-0 p-1">Print Qty(打印次數)</div>
												<div class="col-4 m-0 p-1">
													<input type="number" class="col p-0 rounded" value="1" min="1"
														max="10" oninput="workstation.checkNumberValue(this);">
												</div>
											</div>
											<div class="barcode_package_q d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-9 m-0 p-1">Package Qty(每箱數)</div>
												<div class="col-3 m-0 p-1">
													<input type="number" class="col p-0 rounded" value="1" min="1"
														max="100" oninput="workstation.checkNumberValue(this);">
												</div>
											</div>
											<div class="barcode_label_q d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-9 m-0 p-1">Label Qty(每標數)</div>
												<div class="col-3 m-0 p-1">
													<input type="number" class="col p-0 rounded" value="1" min="1"
														max="10" oninput="workstation.checkNumberValue(this);">
												</div>
											</div>
											<div class="label_lc1 d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-12 m-0 p-1">Customized_LC1(自訂)</div>
												<textarea class="col-12 m-0 p-1" rows="1" cols=""
													placeholder="自訂義_C1欄位"></textarea>
											</div>
											<div class="label_lc2 d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-12 m-0 p-1">Customized_LC2(自訂)</div>
												<textarea class="col-12 m-0 p-1" rows="1" cols=""
													placeholder="自訂義_C2欄位"></textarea>
											</div>
											<div class="label_lc3 d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-12 m-0 p-1">Customized_LC3(自訂)</div>
												<textarea class="col-12 m-0 p-1" rows="1" cols=""
													placeholder="自訂義_C3欄位"></textarea>
											</div>
											<div class="label_lc4 d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-12 m-0 p-1">Customized_LC4(自訂)</div>
												<textarea class="col-12 m-0 p-1" rows="1" cols=""
													placeholder="自訂義_C4欄位"></textarea>
											</div>
											<div class="front_from d-none p-1 m-0 mb-2 row bg-light">
												<div class="col-12 m-0 p-1">Front_From(登記)</div>
												<p class="from_fixed_def  d-none col-4 m-0 p-1"></p>
												<p class="from_sn_def  d-none  col-8 m-0 p-1"></p>
											</div>
										</div>
									</div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</form>
	</div>
</div>
<script type="text/javascript">
	//控制端
	workstation = new Vue({
		el: "#workstation",
		//資料區
		data: {
			test: 300,
			//籃框位置
			nb: 0,
			nb_max: 6,
			//維修代碼
			fix_type: {},
			fix_item: {},
			fix_code_type: "",//暫存維修屬性
			//上次使用的code
			barcode_save: false,
			barcode_check: false,
			//克隆 SN_LIST
			sn_list_example: "",
			//裝箱數量結算
			sn_box_number: 0,
			sn_box_list: [],
			//結單
			check_end: false,
			//項目 / 標題
			fix_i_open: 0,
			fix_t_open: 0,
			//標籤記憶
			rber_pr_set: [],
			//obj_label 標籤群組
			obj_label: {},
			force_label: true,//強制打印: false = 自動打印/ true = 強制打印
			temp_w_focus_5: "",//傳送新標籤需用到
		},
		//初始化
		created() {
			t_alert.sound_warning = true;
			console.log("workstation.html(created)");
			//限制動作5碼
			this.create_barcode("barcode_BC001", "BC001", "code39", 22);
			this.create_barcode("barcode_BC002", "BC002", "code39", 22);
			this.create_barcode("barcode_BC003", "BC003", "code39", 22);
			this.create_barcode("barcode_BC004", "BC004", "code39", 22);
			this.create_barcode("barcode_BC005", "BC005", "code39", 22);
			this.create_barcode("barcode_BC006", "BC006", "code39", 22);
			this.create_barcode("barcode_BC007", "BC007", "code39", 22);
			this.create_barcode("barcode_BC015", "BC015", "code39", 22);

			//上下滑動
			this.create_barcode("barcode_BC016", "BC016", "code39", 22);
			this.create_barcode("barcode_BC017", "BC017", "code39", 22);
			this.create_barcode("barcode_BC018", "BC018", "code39", 22);
			this.create_barcode("barcode_BC019", "BC019", "code39", 22);


			//標籤開關
			this.create_barcode("barcode_BC008", "BC008", "code39", 22);
			this.create_barcode("barcode_BC009", "BC009", "code39", 22);
			this.create_barcode("barcode_BC010", "BC010", "code39", 22);
			this.create_barcode("barcode_BC011", "BC011", "code39", 22);
			//this.create_barcode("barcode_BC012","BC012","code39",22);
			//標籤清除
			this.create_barcode("barcode_BC023", "BC023", "code39", 22);

			//維修代號
			this.create_barcode("barcode_BC013", "BC013", "code39", 22);
			this.create_barcode("barcode_BC014", "BC014", "code39", 22);

			//過站模式
			this.create_barcode("barcode_BC020", "BC020", "code39", 22);
			this.create_barcode("barcode_BC021", "BC021", "code39", 22);
			this.create_barcode("barcode_BC022", "BC022", "code39", 22);

			//監聽資訊-尋找是否有類似值
			$(document).on("input", "#fix_i_textarea_zzzz", function () {
				//console.log($(this).val()); 
				//console.log(workstation.fix_type);
				var search_fix = "";
				//故障-類別
				var p = workstation.fix_type;
				if ($(this).val() != "") {
					for (var key_p in p) {
						if (p.hasOwnProperty(key_p)) {
							//console.log(key_p + " -> " + p[key]);
							//故障-項目
							var k = p[key_p]['item'];
							for (var key_k in k) {
								if (k.hasOwnProperty(key_k) && (k[key_k].toLowerCase()).indexOf($(this).val().toLowerCase()) >= 0) {
									//console.log(key_k + " -> " + k[key_k]);
									search_fix += (key_k + " -> " + k[key_k] + "<br> ");
								}
							}
						}
					}
				}
				$("#fix_i_ex_value").html(search_fix);
			});

			//barcode_open 顯示 ?
			$(document).on("click", ".pn__op", function (event) {
				console.log(event.currentTarget.id);
				$("#" + event.currentTarget.id.replace("_op", "")).removeClass("d-none");

				$("#" + event.currentTarget.id).addClass("d-none");
				$("#" + event.currentTarget.id.replace("_op", "_cl")).removeClass("d-none");
			});
			//barcode_open 不顯示 ?
			$(document).on("click", ".pn__cl", function (event) {
				console.log(event.currentTarget.id);
				$("#" + event.currentTarget.id.replace("_cl", "")).addClass("d-none");

				$("#" + event.currentTarget.id).addClass("d-none");
				$("#" + event.currentTarget.id.replace("_cl", "_op")).removeClass("d-none");
			});

			//barcode_open 顯示 ?
			$(document).on("click", "#barcode_open", function (event) {
				console.log("barcode_open");
				$(".barcode_open").toggle("fast");
			});
			//doc_open 顯示 ?
			$(document).on("click", "#doc_open", function (event) {
				console.log("doc_open");
				$(".doc_open").toggle("normal");
				// var sound = $("#warning");
			});
			//fix_open 顯示?
			$(document).on("click", "#fix_open", function (event) {
				console.log("fix_open");
				$("#fix_t_open").toggle("fast");
				$("#use_explain").toggle("fast");
				$(".fix_open").toggle("fast");
				//如果顯示則關閉
				if ($("#fix_i_open").css('display') != 'none') {
					$("#fix_i_open").toggle("fast");
				}
			});
			//barcode_action-> m_order行為執行?
			$(document).on("click", ".barcode_action", function (event) {
				console.log("barcode_action");
				console.log(event.currentTarget.id);
				$("#m_order").val(event.currentTarget.id);
				$("#send_command_btn").trigger("click");

			});
			//13=Enter 17 = Ctrl 上=38 下=40 左 = 39 右37
			var map = {17: false, 37: false, 38: false, 39: false, 40: false, 13: false, 81: false};
			$(document).on("keydown", function (e) {
				//console.log("keydown:"+e.which);
				if (e.which in map) {
					map[e.which] = true;
					//Enter 回歸[輸入]對焦
					if (map[17] && map[13]) {
						console.log("keydown:" + e.which);
						$('#m_order').focus();
						workstation.clearOrder();
					}
					//右移 清除
					if (map[17] && map[37]) {
						console.log("keydown:" + e.which);
						$('#m_order').val('BC005');
						workstation.send_command();
					}
					//上移
					if (map[17] && map[38]) {
						console.log("keydown:" + e.which);
						$('#m_order').val('BC001');
						workstation.send_command();
					}
					//左移 檢查
					if (map[17] && map[39]) {
						console.log("keydown:" + e.which);
						$('#m_order').val('BC003');
						workstation.send_command();
					}
					//下移
					if (map[17] && map[40]) {
						console.log("keydown:" + e.which);
						$('#m_order').val('BC002');
						workstation.send_command();
					}
				}
			})
			$(document).on("keyup", function (e) {
				if (e.which in map) {
					//console.log("keyup:"+e.which);
					map[e.which] = false;
				}
			});

			main.loading(false);
		},
		//可呼叫方法
		methods: {
			//初始化 fix 格式
			fix_barcode_init(fix_info) {
				this.fix_type = {};
				this.fix_type = fix_info;
				//console.log(this.fix_type);
				//vvv測試格式vvv
				//for(var a = 0;a<=10;a++){
				//	//item
				//	var json_fix_item = {}; 
				//	json_fix_item['name'] = '(測)維修代碼'+a;
				//	var fix_item_one ={};
				//	for(var b = 0;b<=10;b++){
				//		fix_item_one['FI'+(b+'').padStart(3, '0')] = '說明:'+a+'_'+b;
				//	}
				//	json_fix_item['item'] = fix_item_one;
				//	//type
				//	this.fix_type["FT"+(a+'').padStart(3, '0')] = json_fix_item;
				//}
				//^^^測試格式^^^
				//顯示[維修]屬性內容
				this.fix_type = main.orderedSort(this.fix_type);
				for (var a = 0; a < Object.keys(this.fix_type).length; a++) {
					var key_id = Object.keys(this.fix_type)[a];
					var key_name = this.fix_type[key_id].name;

					var fix_t_example = $("#fix_t_example").clone();
					fix_t_example[0].id = "";
					fix_t_example[0].children[0].children[1].innerText = '[' + key_id + ']' + key_name;
					fix_t_example[0].children[0].children[1].title = '[' + key_id + ']' + key_name;
					fix_t_example[0].children[0].children[1].id = key_id;
					fix_t_example[0].children[0].children[0].id = 'barcode_' + key_id;
					fix_t_example[0].children[0].children[0].innerText = "";
					fix_t_example.insertBefore("#fix_t_example");
					//建立新code
					this.create_barcode('barcode_' + key_id, key_id, "code39", 22);
					//console.log(fix_t_example);
				}
				//自定義寫入
				var key_id = 'ZZZ';
				var key_name = '<自定義>產品故障';
				var fix_t_example = $("#fix_t_example").clone();
				fix_t_example[0].id = "";
				fix_t_example[0].children[0].children[1].innerText = '[' + key_id + ']' + key_name;
				fix_t_example[0].children[0].children[1].title = '[' + key_id + ']' + key_name;
				fix_t_example[0].children[0].children[1].id = key_id;
				fix_t_example[0].children[0].children[0].id = 'barcode_' + key_id;
				fix_t_example[0].children[0].children[0].innerText = "";
				fix_t_example.insertBefore("#fix_t_example");
				//建立新code
				this.create_barcode('barcode_' + key_id, key_id, "code39", 22);
				$("#fix_t_example").addClass('d-none');

				//console.log(this.fix_type);
			},
			// 初始化 doc 格式
			doc_init(title) {
				for (var i = 0; i < Object.keys(title).length; i++) {
					var doc_example = $("#doc_example").clone(); //複製樣本
					var value = title[Object.keys(title)[i]].value;
					var name = title[Object.keys(title)[i]].name;
					var col = title[Object.keys(title)[i]].col;
					var id = title[Object.keys(title)[i]].id;
					var tag = title[Object.keys(title)[i]].tag;
					doc_example[0].className = "p-0 " + col;
					doc_example[0].id = id;
					doc_example.insertBefore("#doc_example");
					$('#' + id + ' .doc_c_name').text(name);
					$('#' + id + ' .doc_c_value').val(value);
					if (tag == "textarea") {
						$('#' + id + ' input').addClass("d-none");
						$('#' + id + ' textarea').removeClass("d-none");
					}
					//配色 m__pb_workstation 工作站顯示用
					if (id == 'm__pb_workstation') {
						$('#' + id + ' .doc_c_value').addClass("font-weight-bold");
						$('#' + id + ' .doc_c_value').addClass("text-dark");
						$('#' + id + ' .doc_c_value').addClass("h4");
						$('#' + id + ' .doc_c_value').addClass("mb-0");

					}
					console.log(name + " " + value + " " + col);
				}
			},
			//初始化 客製化 SN
			sn_init() {
				this.sn_list_example = $("#workstation_example").clone();
				$("#workstation_example").remove();
				//自動指令
				if (main.send_command.split("/").length >= 4) {
					$("#w_focus_0").val(main.send_command.split("/")[1]);//*作業人(s):
					$("#w_focus_1").val(main.send_command.split("/")[2]);//*工作站:
					//有標籤指定:
					if (main.send_command.split("/").length > 4) {
						$("#ex_label_id .printer_c input").val(main.send_command.split("/")[4]);
					}
					//*模式:
					$("#m_order").val(main.send_command.split("/")[3]);
					workstation.send_command();
					//下移
					setTimeout(function () {
						$('#m_order').val('BC002');
						workstation.send_command();
					}, 500);
					setTimeout(function () {
						$('#m_order').val('BC002');
						workstation.send_command();
					}, 1000);
				}
				main.send_command = '';
			},
			//建立 一維條碼
			create_barcode(taget_id, barcode_val, code, h_size) {
				/*
				barWidth: 1,barHeight: 50,
				moduleSize: 5,showHRI: true,
				addQuietZone: true,	marginHRI: 5,
				bgColor: "#FFFFFF",	color: "#000000",
				fontSize: 10,output: "css",
				posX: 0,posY: 0
				*/
				var barcode_f = {
					barWidth: "1",
					barHeight: h_size,
					showHRI: false,
					bgColor: "#FFFFFF", color: "#000000",
					output: "css",
				};
				$("#" + taget_id).barcode(barcode_val, code, barcode_f);
			},
			//執行動作
			send_command() {
				//上階段已執行完畢
				if (!$("#nav_loading").hasClass("d-none")) {
					$('#m_order').val("");
					return false;
				}

				setTimeout(function () {
					console.log("send_command :" + $('#m_order').val());
					var code = $('#m_order').val().replace('barcode_', '').toUpperCase();//排除多餘字
					var id = $(".border-1").attr("id");
					console.log(id);
					//沒輸入則不動
					if (code == "") {
						workstation.clearOrder();
						return false;
					}
					//指令類型
					switch (code) {
						case "ENTER":
							workstation.clearOrder();
							return false;
							break;
						case "3X1AUTO":
							if ($("#sn_one_check").prop("checked")) {
								$("#sn_one_check").prop("checked", false);
								$("#sn_one_3x1_cl").trigger("click");
							} else {
								$("#sn_one_check").prop("checked", true);
								$("#sn_one_3x1_op").trigger("click");
							}
							$('#m_order').val('');
							$("html, body").animate({scrollTop: 400}, 'fast');
							return false;
							break;
						case "3X1EXCLUDE":
							if ($("#ph_p_no_number").prop("checked")) {
								$("#ph_p_no_number").prop("checked", false);
							} else {
								$("#ph_p_no_number").prop("checked", true);
							}
							$('#m_order').val('');
							$("html, body").animate({scrollTop: 400}, 'fast');
							return false;
							break;
						case "3X1PART":
							if ($("#ph_mfg_p_no").prop("checked")) {
								$("#ph_mfg_p_no").prop("checked", false);
							} else {
								$("#ph_mfg_p_no").prop("checked", true);
							}
							$('#m_order').val('');
							$("html, body").animate({scrollTop: 400}, 'fast');
							return false;
							break;
						case "3X1PCODE":
							$('#barcode_sn_one_printer').focus();
							$('#m_order').val('');
							$("html, body").animate({scrollTop: 400}, 'fast');
							return false;
							break;
						case "3X1PQTY":
							$('#barcode_sn_one_nb').focus();
							$('#m_order').val('');
							$("html, body").animate({scrollTop: 400}, 'fast');
							return false;
							break;
						case "BC001":
							//目前代碼位置 
							if (workstation.nb > 0) {
								workstation.nb = parseInt(id.replace('w_focus_', ''));
								workstation.nb -= 1;
								if ($('.w_i_' + workstation.nb).hasClass('d-none')) {
									workstation.nb -= 1;
								}
								//更換Class
								$("#" + id).removeClass("border-1");
								$("#" + id).addClass("border-0");
								$("#w_focus_" + workstation.nb).addClass("border-1");
								$("#w_focus_" + workstation.nb).removeClass("border-0");
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC002":
							//目前代碼位置 
							if (workstation.nb + 1 < $(".w_sn_value").length) {
								workstation.nb = parseInt(id.replace('w_focus_', ''));
								workstation.nb += 1;
								//可能有 舊的燒錄序號
								if ($('.w_i_' + workstation.nb).hasClass('d-none')) {
									if ($(".w_sn_value").length > 7) {
										workstation.nb += 1;
									}
									else if ($(".w_sn_value").length == 7 && workstation.nb == 6) {
										workstation.clearOrder();
										return false;
									}
								}

								//更換Class
								$("#" + id).removeClass("border-1");
								$("#" + id).addClass("border-0");
								$("#w_focus_" + workstation.nb).addClass("border-1");
								$("#w_focus_" + workstation.nb).removeClass("border-0");
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC003":
							var w_focus_1 = $('#w_focus_1').val();
							var w_focus_2 = $('#w_focus_2').val();
							var w_focus_5 = $('#w_focus_5').val();
							//進行查詢(製令單/工作站/序號)
							if (w_focus_1 != "" && w_focus_2 != "" && w_focus_5 != "") {
								workstation.sendCheck();
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC004":
							workstation.check_end = false;
							//存檔+避免w_focus_5 (SN)
							if ($("#w_focus_5").val() != "" && workstation.barcode_check) {
								//Step3.存檔
								workstation.sendSave();
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC005":
							//清除
							if (!$('#' + id).hasClass('sn_only')) {
								$('#' + id).val("");
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC006":
							//取消全部
							$('.w_sn_value').val("");
							workstation.nb = 0;
							//更換Class
							$("#" + id).removeClass("border-1");
							$("#" + id).addClass("border-0");
							$("#w_focus_" + workstation.nb).addClass("border-1");
							$("#w_focus_" + workstation.nb).removeClass("border-0");
							$('.doc_c_value').val("");
							$(".sn_list").remove();
							//標籤清除
							$("#label_pr_id").text("");
							$("#label_group").text("");

							$(".label_re").remove();
							$(".label_hr").remove();

							workstation.barcode_save = false;
							workstation.barcode_check = false;
							workstation.clearOrder();
							return false;
							break;
						case "BC007":
							//登出
							window.location.replace("./logout.basil");
							workstation.clearOrder();
							return false;
							break;
						case "BC008":
							//顯示barcode
							$("#barcode_open").trigger("click");
							workstation.clearOrder();
							return false;
							break;
						case "BC009":
							//顯示fix
							$("#fix_open").trigger("click");
							workstation.clearOrder();
							return false;
							break;
						case "BC010":
							//顯示doc
							$("#doc_open").trigger("click");
							workstation.clearOrder();
							return false;
							break;
						case "BC011":
							/*
							//Old_Save->打印條碼->清除內容 && SN 不得為空
							if(workstation.barcode_check && ($('#sn_one_check').is(":checked") || 
									$('#sn_double_check').is(":checked") || 
									$('#sn_big_check').is(":checked"))){
								console.log('Save->打印條碼 : BC011');
								//Step2.建立打印頁面
								var css = '<link rel="stylesheet" href="./css/model/print_code.css" />';
									css +='<link rel="stylesheet" href="./thirdparty/css/bootstrap-4.6.0.min.css" />';
								//3*1
								var divToPrint=$('<div>').append($('#barcode_sn_print').clone()).html();
								var divToPrint2=$('<div>').append($('.barcode_sn_print_list').clone()).html();
								//3*2
								var divToPrint_double=$('<div>').append($('#barcode_sn_double_print').clone()).html();
								//6*10
								var divToPrint_big=$('<div>').append($('#barcode_sn_big_list').clone()).html();
								//==數量==
								var print_all='';
								//3*1
								if($('#sn_one_check').is(":checked") && $("#barcode_sn_one_printer").val()==""){
									for(var d =1 ;d<$('#barcode_sn_one_nb').val();d++ ){
										print_all += divToPrint+'<p style="page-break-after:always"></p>';
										if(divToPrint2!=null){
											print_all+=divToPrint2+'<p style="page-break-after:always"></p>';
										}
									}
									print_all+=divToPrint;
									if(divToPrint2!=null){
										print_all+='<p style="page-break-after:always"></p>'+divToPrint2;
									}
								}
								//3*2
								if($('#sn_double_check').is(":checked") && $("#barcode_sn_double_printer").val()==""){
									if(print_all!=''){
										print_all+='<p style="page-break-after:always"></p>';
									}
									for(var d =1 ;d<$('#barcode_sn_double_nb').val();d++ ){
										print_all += divToPrint_double+'<p style="page-break-after:always"></p>';
									}
									print_all+=divToPrint_double;
								}
								//6*10 
								if($('#sn_big_check').is(":checked") && $("#barcode_sn_big_printer").val()==""){
									if(print_all!=''){
										print_all+='<p style="page-break-after:always"></p>';
									}
									for(var d =1 ;d<$('#barcode_sn_big_nb').val();d++ ){
										print_all += divToPrint_big+'<p style="page-break-after:always"></p>';
									}
									print_all+=divToPrint_big;
								}
								
								if(print_all!=''){
									
									var print_all = '<html><head>'+css+'</head>'+
									'<body class="row justify-content-center" style="font-size: 20px;line-height:25px;" onload="print()">'+
									'<div>'+print_all+'</div></body></html>';
									var newWin=window.open('','Print-Window');
									newWin.document.open();
									newWin.document.write(print_all);
									newWin.document.close();
									setTimeout(function(){newWin.close();},650);
									workstation.barcode_save = false;
									
								}
								
								//Step5.更換Class
								var id =$(".border-1").attr("id");
								workstation.nb = 5;
								$("#"+id).removeClass("border-1");
								$("#"+id).addClass("border-0");
								$("#w_focus_"+workstation.nb).addClass("border-1");
								$("#w_focus_"+workstation.nb).removeClass("border-0");
								
								//打印指令
								workstation.sendPrinter(true);
							}*/

							//New 標籤設計模式
							if (workstation.barcode_check && $('.label_auto').is(":checked")) {
								//打印指令
								workstation.sendPrinter(false);
							}

							workstation.clearOrder();
							return false;
							break;
						case "BC015":
							//結單
							workstation.check_end = true;
							if ($("#w_focus_5").val() != "" && workstation.barcode_check) {
								//Step3.存檔
								const todayDate = (function getTodayDate() {
									const today = new Date();
									const year = today.getFullYear();
									const month = String(today.getMonth() + 1).padStart(2, '0');
									const day = String(today.getDate()).padStart(2, '0');
									return `${year}-${month}-${day}`;
								})(); // 執行函式，將結果存入 todayDate
								let inputDate = prompt("請輸入今天的日期 (格式：YYYY-MM-DD):", "");

								while (inputDate !== todayDate) {
									if (inputDate === null) {
										alert("操作取消。");
										return;
									}
									alert("日期錯誤，請重新輸入！");
									inputDate = prompt("請輸入今天的日期 (格式：YYYY-MM-DD):", "");
								}
								alert("日期正確！->執行結單");
								workstation.sendSave();
							}
							return false;
							break;
						case "BC016":
							//類別
							if (workstation.fix_t_open - 280 <= 0) {
								workstation.fix_t_open = 0;
								$("#fix_t_open").animate({scrollTop: workstation.fix_t_open}, 'fast');
							} else {
								workstation.fix_t_open -= 280;
								$("#fix_t_open").animate({scrollTop: workstation.fix_t_open}, 'fast');
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC017":
							//原始位置+預設高度+下次移動高度 最大值
							if ($("#fix_t_open").scrollTop() + 280 + 280 >= $("#fix_t_open").prop("scrollHeight")) {
								workstation.fix_t_open = $("#fix_t_open").prop("scrollHeight") - 280;
								$("#fix_t_open").animate({scrollTop: (workstation.fix_t_open)}, 'fast');
							} else {
								workstation.fix_t_open += 280;
								$("#fix_t_open").animate({scrollTop: workstation.fix_t_open}, 'fast');
							}
							console.log("目前位置:" + $("#fix_t_open").scrollTop());
							console.log("總高度置:" + $("#fix_t_open").prop("scrollHeight"));
							workstation.clearOrder();
							return false;
							break;
						case "BC018":
							//項目
							if (workstation.fix_i_open - 305 <= 0) {
								workstation.fix_i_open = 0;
								$("#fix_i_open").animate({scrollTop: workstation.fix_i_open}, 'fast');
							} else {
								workstation.fix_i_open -= 305;
								$("#fix_i_open").animate({scrollTop: workstation.fix_i_open}, 'fast');
							}
							workstation.clearOrder();
							return false;
							break;
						case "BC019":
							//原始位置+預設高度+下次移動高度 最大值
							if ($("#fix_i_open").scrollTop() + 305 + 305 >= $("#fix_i_open").prop("scrollHeight")) {
								workstation.fix_i_open = $("#fix_i_open").prop("scrollHeight") - 305;
								$("#fix_i_open").animate({scrollTop: (workstation.fix_i_open)}, 'fast');
							} else {
								workstation.fix_i_open += 305;
								$("#fix_i_open").animate({scrollTop: workstation.fix_i_open}, 'fast');
							}
							console.log("目前位置:" + $("#fix_i_open").scrollTop());
							console.log("總高度置:" + $("#fix_i_open").prop("scrollHeight"));

							workstation.clearOrder();
							return false;
							break;
						case "BC020":
							//檢查模式
							$("#checkbox_plt input").prop("checked", false);
							$("#checkbox_only input").prop("checked", false);
							$("#checkbox_auto input").prop("checked", false);
							$("#checkbox_sound input").prop("checked", false);
							$("#checkbox_only_one_pass input").prop("checked", false);

							$("#after_sn_check").prop("checked", true);
							$("#set_check_replace").prop("checked", true);
							workstation.clearOrder();
							return false;
							break;
						case "BC021":
							//一般模式
							$("#checkbox_plt input").prop("checked", false);
							$("#checkbox_only input").prop("checked", false);
							$("#checkbox_auto input").prop("checked", false);
							$("#checkbox_sound input").prop("checked", false);
							$("#checkbox_only_one_pass input").prop("checked", true);


							$("#checkbox_only_one_pass").prop("checked", true);
							$("#after_sn_save").prop("checked", true);
							$("#after_sn_check").prop("checked", true);
							$("#set_replace").prop("checked", true);
							$("#set_success").prop("checked", true);
							workstation.clearOrder();
							return false;
							break;
						case "BC022":
							//PLT模式
							$("#checkbox_plt input").prop("checked", false);
							$("#checkbox_only input").prop("checked", false);
							$("#checkbox_auto input").prop("checked", false);
							$("#checkbox_sound input").prop("checked", false);
							$("#checkbox_only_one_pass input").prop("checked", false);

							$("#checkbox_plt input").prop("checked", true);
							$("#only_check").prop("checked", true);
							$("#after_sn_save").prop("checked", true);
							$("#after_sn_check").prop("checked", true);
							$("#set_replace").prop("checked", true);
							$("#set_success").prop("checked", true);
							workstation.clearOrder();
							return false;
							break;
						case "BC023":
							//清除包裝資料
							$(".from_fixed").remove();
							$(".from_sn").remove();
							workstation.clearOrder();
							return false;
							break;
						default:
							break;
					}
					//是否為維修代碼(群組類別)
					if (workstation.fix_type[code] != null || code == 'ZZZ') {
						//如果沒有打開
						if ($('#fix_t_open').css('display') == 'none') {
							$("#fix_open").trigger("click");
						}

						if (($("#fix-item").text() != code && $("#fix_i_open").css("display") == "none") || $("#fix-item").text() == code || $("#fix-item").text() == "") {
							$("#fix_i_open").slideToggle("fast");
						}
						console.log(id);
						workstation.nb = parseInt(id.replace('w_focus_', ''));
						workstation.nb = 4;
						//更換Class
						$("#" + id).removeClass("border-1");
						$("#" + id).addClass("border-0");
						$("#w_focus_" + workstation.nb).addClass("border-1");
						$("#w_focus_" + workstation.nb).removeClass("border-0");
						//scrollTop 歸位
						workstation.fix_i_open = 0;
						$("#fix_i_open").animate({scrollTop: (workstation.fix_i_open)}, 'fast');
						//顯示[維修]屬性內容
						$("#fix_i_example").removeClass('d-none');
						$(".fix_i_list").remove();

						//一般維修
						if (code != 'ZZZ') {
							var items = workstation.fix_type[code]['item'];

							$("#fix-item").attr('title', workstation.fix_type[code]['name']);
							$("#fix-item").text(workstation.fix_type[code]['name']);
							items = main.orderedSort(items);//排序

							for (var a = 0; a < Object.keys(items).length; a++) {
								var key_id = Object.keys(items)[a];
								var key_name = items[key_id];

								var fix_t_example = $("#fix_i_example").clone();
								fix_t_example[0].id = "";
								fix_t_example[0].className = "p-1 fix_i_list col-6";

								fix_t_example[0].children[0].children[1].innerText = '[' + key_id + ']' + key_name;
								fix_t_example[0].children[0].children[1].title = '[' + key_id + ']' + key_name;
								fix_t_example[0].children[0].children[1].id = key_id;
								fix_t_example[0].children[0].children[0].id = 'barcode_' + key_id;
								fix_t_example[0].children[0].children[0].innerText = "";

								fix_t_example.insertBefore("#fix_i_example");
								//建立新code
								workstation.create_barcode('barcode_' + key_id, key_id, "code39", 22);
								//console.log(fix_t_example);
								$("#fix_i_ex").addClass("d-none");
							}
						} else {
							//自訂維修
							$("#fix-item").attr('title', '<自定義>產品故障');
							$("#fix-item").text('<自定義>產品故障');
							var key_id = 'ZZZZ';
							var key_name = '<自定義>故障敘述';
							var fix_t_example = $("#fix_i_example").clone();
							fix_t_example[0].id = "";
							fix_t_example[0].className = "p-1 fix_i_list col-12";

							fix_t_example[0].children[0].children[2].id = "fix_i_textarea_zzzz";
							fix_t_example[0].children[0].children[2].className = "p-1 col-12";
							fix_t_example[0].children[0].children[1].innerText = '[' + key_id + ']' + key_name;
							fix_t_example[0].children[0].children[1].title = '[' + key_id + ']' + key_name;
							fix_t_example[0].children[0].children[1].id = key_id;
							fix_t_example[0].children[0].children[0].id = 'barcode_' + key_id;
							fix_t_example[0].children[0].children[0].innerText = "";

							fix_t_example.insertBefore("#fix_i_example");
							//建立新code
							workstation.create_barcode('barcode_' + key_id, key_id, "code39", 22);
							$("#fix_i_ex").removeClass("d-none");
						}

						$("#fix_i_example").addClass('d-none');
						workstation.fix_code_type = code;
						workstation.clearOrder();
						return false;
					}
					//只有在[維修欄位]上
					if (id == 'w_focus_4') {
						//(項目類別) 自訂義故障 or 以定義故障
						if ((code == 'ZZZZ') ||
							(workstation.fix_code_type != 'ZZZ' &&
								workstation.fix_code_type != "" &&
								workstation.fix_type[workstation.fix_code_type].item[code] != null)) {
							//維修代碼-如果是自訂義(必須要有自訂義內容)
							if (code == 'ZZZZ') {
								if (workstation.fix_code_type == 'ZZZ' && $('#fix_i_textarea_zzzz').val() != '') {
									code += '[' + $('#fix_i_textarea_zzzz').val() + ']';
									$('#fix_i_textarea_zzzz').val("");
								} else {
									workstation.clearOrder();
									return false;
								}
							}

							//維修代碼-複數已經存在?
							if ($('#' + id).val() != "") {
								$('#' + id).val($('#' + id).val() + '_' + code);
							} else {
								$('#' + id).val(code);
							}
							workstation.clearOrder();
							return false;
						} else {
							//不在故障代碼規範內
							workstation.clearOrder();
							return false;
						}
					}
					//略Workstation User(可能有複數)
					if (workstation.nb == 0) {
						if ($('#' + id).val() == "") {
							$('#' + id).val(code);
						} else {
							$('#' + id).val($('#' + id).val() + '_' + code);
						}
						workstation.clearOrder();
						return false;
					}
					//輸入一般值->換下一格
					if (!$('#' + id).hasClass("sn_only")) {
						$('#' + id).val(code);
					}

					//自動位移
					if (workstation.nb + 1 < $(".w_sn_value").length) {
						//console.log(id);
						workstation.nb = parseInt(id.replace('w_focus_', ''));
						workstation.nb += 1;
						if ($('.w_i_' + workstation.nb).hasClass('d-none')) {
							if (workstation.nb + 1 < $(".w_sn_value").length) {
								workstation.nb += 1;
							} else {
								workstation.nb -= 1;
							}
						}
						//跳過 Error Code + Product Patch
						if (workstation.nb == 3 || workstation.nb == 4) {
							workstation.nb = 5;
						}
						//更換Class
						$("#" + id).removeClass("border-1");
						$("#" + id).addClass("border-0");
						$("#w_focus_" + workstation.nb).addClass("border-1");
						$("#w_focus_" + workstation.nb).removeClass("border-0");
					}
					workstation.clearOrder();
					//如果輸入有勾選自動存檔
					if ($('#after_sn_save').is(":checked") && id == 'w_focus_5' && workstation.barcode_check) {
						$("#BC004").trigger("click");
						return false;
					}
					//如果輸入有勾選自動檢查
					if ($('#after_sn_check').is(":checked") && id == 'w_focus_5') {
						$("#BC003").trigger("click");
						return false;
					}
					//如果輸入有勾選自動檢查
					if ($('#after_sn_check').is(":checked") && id == 'w_focus_6') {
						$("#BC003").trigger("click");
						return false;
					}

				}, 300);


				return false; //防止真傳送
			},
			//檢查數字是否超標
			checkNumberValue(event) {
				if (parseInt(event.value) > parseInt(event.max)) {
					event.value = event.max;
				} else if (parseInt(event.value) < parseInt(event.min)) {
					event.value = event.min;
				} else if (event.value == "") {
					event.value = event.min;
				}
			},
			clearOrder() {
				//setTimeout(function(){
				//清除
				$('#m_order').val('');
				$('#m_order').focus();
				$("html, body").animate({scrollTop: 100}, 'fast');
				//},200);
			},
			//指令列印
			sendPrinter(fixed) {
				var action = "PT";
				var s_type = "POST";
				var s_url = "";
				var s_data = {};
				var req = {};
				req.user = $('#name').text();
				req.date = new Date();
				req.body = {};
				req.page_total = this.page_total;
				req.page_batch = this.page_batch;
				req.page_now_nb = this.page_now_nb;
				req.html_body = "";
				req.call_bk_fn = "workstation_printer";

				//printer data
				var printer = {};
				/*if(fixed){
				//========標籤(固定模式)========
					//========3*1========
					if($("#barcode_sn_one_printer").val()!=""){
						var label_list=[];
						for(var x =0;x<$("#barcode_3X1_print .order_print").length;x++){
							var label = {}
							label['part_no'] = $("#barcode_3X1_print #barcode_p_number")[x].innerText;
							label['product_number']= "";
							label['sn_name']= $("#barcode_3X1_print .order_print")[x].innerText.split(" ")[0];
							label['sn_value']= $("#barcode_3X1_print .order_print")[x].innerText.split(" ")[1];
							label_list.push(label);
						}   			
						printer['label_3X1_nb'] = $("#barcode_sn_one_nb").val();
						printer['label_3X1_list'] = label_list;
						printer['printer_3X1_code'] = $("#barcode_sn_one_printer").val();   				
					}
					//========3*2========
					if($("#barcode_sn_double_printer").val()!=""){
						var label_list=[];
						var label = {}
						label['part_no'] = $("#barcode_sn_double_print #barcode_p_double_number").text();
						label['product_number']= "";
						label['sn_name_1']= $("#barcode_sn_double_print #barcode_sn_double_name").text().split(" ")[0];
						label['sn_value_1']= $("#barcode_sn_double_print #barcode_sn_double_name").text().split(" ")[1];
						label['sn_name_2']= $("#barcode_sn_double_print #barcode_sn_double_name2").text().split(" ")[0];
						label['sn_value_2']= $("#barcode_sn_double_print #barcode_sn_double_name2").text().split(" ")[1];	
						//包裝
						printer['label_3X2_nb'] = $("#barcode_sn_double_nb").val();
						printer['label_3X2_list'] = label;
						printer['printer_3X2_code'] = $("#barcode_sn_double_printer").val();   				
					}
				}else{*/
				//========自定義標籤(設計模式)========
				if ($('.label_auto').is(":checked")) {
					printer['label_list'] = [];
					printer['label_list_sn'] = $('#w_focus_5').val() == "" ? this.temp_w_focus_5 : $('#w_focus_5').val();
					$('.label_auto').map(function () {
						if (this.id != "") {
							var choose_id = this.id.replace("_auto", "");
							var one_label = $("#" + choose_id);
							if (one_label.find(".label_auto").is(":checked")) {
								var label_obj = {};
								//打印?
								label_obj.printer_c = one_label.find('.printer_c input').val();//標籤機代號
								label_obj.barcode_id = choose_id.replace("id_", "").replace("_label", "");//標籤ID
								label_obj.barcode_pt_q = one_label.find('.barcode_print_q  input').val();//打印幾次
								label_obj.barcode_pe_q = "0";//箱上台數
								label_obj.barcode_ll_q = "0";//標籤上台數 
								label_obj.f_f_l = "";//來自前端值
								//============自訂義()============
								label_obj.front_from_lc1 = "";
								label_obj.front_from_lc2 = "";
								label_obj.front_from_lc3 = "";
								label_obj.front_from_lc4 = "";
								if (!one_label.find('.label_lc1').hasClass("d-none")) {
									label_obj.front_from_lc1 = one_label.find('.label_lc1 textarea').val();
								}
								if (!one_label.find('.label_lc2').hasClass("d-none")) {
									label_obj.front_from_lc2 = one_label.find('.label_lc2 textarea').val();
								}
								if (!one_label.find('.label_lc3').hasClass("d-none")) {
									label_obj.front_from_lc3 = one_label.find('.label_lc3 textarea').val();
								}
								if (!one_label.find('.label_lc4').hasClass("d-none")) {
									label_obj.front_from_lc4 = one_label.find('.label_lc4 textarea').val();
								}

								//============外箱組態============
								var from_sn = false;
								var from_fixed = false;
								var from_print = true;//是否滿足打印?
								//有包裝設定?
								if (!one_label.find('.barcode_package_q').hasClass("d-none")) {
									label_obj.barcode_pe_q = one_label.find('.barcode_package_q input').val();
									label_obj.barcode_ll_q = one_label.find('.barcode_label_q input').val();
									//自動打印->需要檢查是否數量正確?
									if (!workstation.force_label) {//打印: false = 自動打印/ true = 強制打印
										if (one_label.find(".front_from .from_sn").length < label_obj.barcode_pe_q) {
											from_print = false;
										}
									}
								}
								//有前端 值入設定?
								if (from_print && one_label.find(".front_from .from_sn").length >= 1) {
									label_obj.f_f_sn = one_label.find(".from_sn").map((_, el) => el.innerHTML).get();
									printer['label_list'].push(label_obj);
									one_label.find(".from_sn").remove();
									from_sn = true;
								} else {
									label_obj.f_f_sn = [];
								}
								//有前端 (固定)值入設定?
								if (from_print && one_label.find(".front_from .from_fixed").length >= 1) {
									label_obj.f_f_f = one_label.find(".from_fixed").map((_, el) => el.innerHTML).get();
									one_label.find(".from_fixed").remove();
									from_fixed = true;
								} else {
									label_obj.f_f_f = [];
								}

								//============以上都不是(非外箱組態)============
								if (!from_sn && !from_fixed) {
									label_obj.f_f_f = [];
									label_obj.f_f_sn = [];
									if (from_print) {
										printer['label_list'].push(label_obj);
									}
								}

							}
						}
					});
					workstation.force_label = true;
				}


				if (/*printer['printer_3X1_code'] !=null ||printer['printer_3X2_code'] !=null||*/printer['label_list'] != null) {
					//包裝(action = AR_AC/AR_AU/AR_AD/PT)
					s_url = (t_body.html_body + "." + action).replace('html', 'basil').replace('body_', '');
					req.action = action;
					req.body = {};
					req.body['printer'] = printer;
					req.call_bk_vals = {};
					s_data.req_content = req;
					main.ajaxSend(s_url, s_type, s_data);
				}
			},
			//存檔
			sendSave() {
				main.loading(true);
				console.log("sendSave");
				var action = "";
				var s_type = "POST";
				var s_url = "";
				var s_data = {};
				var req = {};
				req.user = $('#name').text();
				req.date = new Date();
				req.body = {};
				req.page_total = this.page_total;
				req.page_batch = this.page_batch;
				req.page_now_nb = this.page_now_nb;
				req.html_body = "";
				req.call_bk_fn = "workstation_save";
				req.call_bk_vals = {};
				s_data.req_content = req;
				//modify
				var modify_one = {};
				for (var c = 0; c < $(".w_sn_value").length; c++) {
					var title = $(".w_sn_value")[c].title;
					var id = $(".w_sn_value")[c].id;
					modify_one[title] = $("#" + id).val();

				}
				modify_one['plt_save'] = false;
				modify_one['plt_file_classify'] = false;
				modify_one['plt_check'] = false;
				modify_one['only_one_pass'] = false;

				//歸檔與檢核與檢察
				if ($('#plt_save').is(":checked")) {
					modify_one['plt_save'] = true;
				}
				if ($('#plt_file_classify').is(":checked")) {
					modify_one['plt_file_classify'] = true;
				}
				if ($('#plt_check').is(":checked")) {
					modify_one['plt_check'] = true;
				}
				if ($('#only_one_pass').is(":checked")) {
					modify_one['only_one_pass'] = true;
				}

				//標籤-前端記憶設定
				if ($('#remember_printer_set').is(":checked")) {
					workstation.rber_pr_set = [];
					$('.label_auto').map(function () {
						if (this.id != "" && $("#" + this.id).is(":checked")) {
							var choose_id = this.id.replace("_auto", "");
							var content = {};
							content.id = choose_id;//ID
							content.printer_c = $("#" + choose_id + " .printer_c input").val();
							content.barcode_print_q = $("#" + choose_id + " .barcode_print_q input").val();
							content.barcode_package_q = $("#" + choose_id + " .barcode_package_q input").val();
							content.barcode_label_q = $("#" + choose_id + " .barcode_label_q input").val();
							//包裝類型?
							if (!$("#" + choose_id + " .front_from").hasClass("d-none")) {
								content.barcode_label_package = $("#" + choose_id + " .front_from").html();
							}
							//自定義類型?(label_lc1)
							if (!$("#" + choose_id + " .label_lc1").hasClass("d-none")) {
								content.label_lc1 = $("#" + choose_id + " .label_lc1 textarea").val();
							}
							//自定義類型?(label_lc2)
							if (!$("#" + choose_id + " .label_lc2").hasClass("d-none")) {
								content.label_lc2 = $("#" + choose_id + " .label_lc2 textarea").val();
							}
							//自定義類型?(label_lc3)
							if (!$("#" + choose_id + " .label_lc3").hasClass("d-none")) {
								content.label_lc3 = $("#" + choose_id + " .label_lc3 textarea").val();
							}
							//自定義類型?(label_lc4)
							if (!$("#" + choose_id + " .label_lc4").hasClass("d-none")) {
								content.label_lc4 = $("#" + choose_id + " .label_lc4 textarea").val();
							}

							workstation.rber_pr_set.push(content);
						}
					});
					console.log(workstation.rber_pr_set);
				} else {
					workstation.rber_pr_set = [];
				}

				//包裝(action = AR_AC/AR_AU/AR_AD)
				action = "AU";
				s_type = "PUT";
				s_url = (t_body.html_body + "." + action).replace('html', 'basil').replace('body_', '');
				req.action = action;
				req.body = {};
				req.body['modify'] = modify_one;
				req.body['check_end'] = workstation.check_end;
				req.call_bk_vals = {};
				main.ajaxSend(s_url, s_type, s_data);
			},
			//嘗試存檔後
			saveReturn() {
				//結單關閉
				workstation.check_end = false;
				//Step4-0.過站完成 再檢查一次
				if (main.allData.info_color == "success") {
					workstation.barcode_save = true;
					main.loading(false);
					//取消檢查
					$('#check_end').prop('checked', false);
					$("#BC003").trigger("click");
				} else {
					//失敗
					//Step4-1.回歸自動位移
					var id = $(".border-1").attr("id");
					workstation.nb = 5;
					//更換Class
					$("#" + id).removeClass("border-1");
					$("#" + id).addClass("border-0");
					$("#w_focus_" + workstation.nb).addClass("border-1");
					$("#w_focus_" + workstation.nb).removeClass("border-0");
					$("#doc_all .doc_c_value").val("");
					main.loading(false);
				}
			},
			//檢查
			sendCheck() {
				console.log("sendCheck");
				main.loading(true);
				var search = {};
				search['w_hours'] = $('#w_focus_0').val();
				search['w_c_name'] = $('#w_focus_1').val();
				search['ph_pr_id'] = $('#w_focus_2').val();
				search['pb_b_sn'] = $('#w_focus_5').val();
				search['pb_b_sn_old'] = $('#w_focus_6').val();


				//包裝
				var s_url = (t_body.html_body + ".AR").replace("html", "basil").replace("body_", "");
				var s_type = "POST";
				var s_data = {};
				var req = {};
				req.user = $('#name').text();
				req.date = new Date();
				req.action = "AR";
				req.body = {};
				req.body.search = search;
				req.page_total = 0;
				req.page_batch = 0;
				req.page_now_nb = 0;
				req.html_body = "";
				req.call_bk_fn = "workstation";
				req.call_bk_vals = {};
				s_data.req_content = req;
				//console.log(s_url);
				//傳送
				main.ajaxSend(s_url, s_type, s_data);
			},
			searchReturn() {
				console.log("searchReturn");
				//Step1.如果關閉doc 顯示則
				if ($("#doc_status").css('display') == 'none') {
					$("#doc_open").trigger("click");
				}


				main.loading(false);
				this.barcode_check = true;
				console.log(main.allData.body);
				//Step2.如果沒有資料
				if (main.allData.body.search == null) {
					$(".sn_list .w_sn_value").val("");
					$("#doc_all .doc_c_value").val("");
					//Step2-1.回歸自動位移
					var id = $(".border-1").attr("id");
					workstation.nb = 5;
					//更換Class
					$("#" + id).removeClass("border-1");
					$("#" + id).addClass("border-0");
					$("#w_focus_" + workstation.nb).addClass("border-1");
					$("#w_focus_" + workstation.nb).removeClass("border-0");
					return null;
				}

				//Step3-1.更新doc
				var doc_list = main.allData.body.search[0];
				for (var i = 0; i < Object.keys(doc_list).length; i++) {
					var key = Object.keys(doc_list)[i];
					var value = doc_list[key];
					//測試JSON
					if ("" + value != null && ("" + value).search('},') != -1) {
						value = value.replaceAll('},', '},\n');
					}
					$('#' + key + ' .doc_c_value').val(value);

					//配色 m__pb_workstation 工作站顯示用
					if (key == 'm__pb_workstation') {
						if (value == ">>已經過站<<") {
							$('#' + key + ' .doc_c_value').removeClass("bg-warning");
							$('#' + key + ' .doc_c_value').addClass("bg-success");
						} else {
							$('#' + key + ' .doc_c_value').removeClass("bg-success");
							$('#' + key + ' .doc_c_value').addClass("bg-warning");
						}
					}
				}
				//Step3-2.更新SN_List
				var sn_list = main.allData.body.sn_list;
				var nb = 7;
				//保存勾選
				var save_check = [];
				var save_name = [];
				for (var i = 0; i < $('.sn_list').length; i++) {
					$('#' + $('.sn_list')[i].id + ' .w_sn_value').val("");
					if ($('#' + $('.sn_list')[i].id + ' .w_sn_check').is(":checked")) {
						save_check.push($('#' + $('.sn_list')[i].id).attr('id'));
						save_name.push($('#' + $('.sn_list')[i].id + " .w_sn_name").text());
					}
				}
				//指定重工工單 && 第一站 新建立的SN 才需要 
				if (main.allData.body.workdatation_sort == 1 &&
					($('#m__ph_type .doc_c_value').val() == 'A521_has_sn' ||
						$('#m__ph_type .doc_c_value').val() == 'A521_no_and_has_sn')) {
					$('.w_i_6').removeClass('d-none');
				} else {
					$('#w_focus_6').val("");
					if (!$('.w_i_6').hasClass('d-none')) {
						$('.w_i_6').addClass('d-none');
					}
				}
				//錯誤代碼
				if (main.allData.body.pb_fvalue != null) {
					$('#w_focus_4').val(main.allData.body.pb_fvalue);
				} else {
					$('#w_focus_4').val("");
				}
				//位置代碼
				if (main.allData.body.pb_position != null && main.allData.body.pb_position != "") {
					$('#w_focus_3').val(main.allData.body.pb_position);
				}

				//Step3-3.移除重製
				$(".sn_list").remove();
				for (var i = 0; i < Object.keys(sn_list).length; i++) {
					var one_sn = sn_list[Object.keys(sn_list)[i]];
					var key = Object.keys(one_sn);
					var key_name = one_sn[key]['name'];
					var value_content = one_sn[key]['value'];
					var sn_list_tr = this.sn_list_example.clone();
					sn_list_tr[0].id = key;
					sn_list_tr[0].className = "w_i_" + (nb + i) + " sn_list font-weight-bold";
					sn_list_tr.insertBefore("#sn_example");
					$(".w_i_" + (nb + i) + " .w_sn_name").text(key_name);
					$(".w_i_" + (nb + i) + " .w_sn_value").val(value_content);
					$(".w_i_" + (nb + i) + " .w_sn_value").attr("id", "w_focus_" + (nb + i));
					$(".w_i_" + (nb + i) + " .w_sn_value").attr("title", key);
					//唯讀
					if (one_sn[key]['woption'] == 2) {
						$(".w_i_" + (nb + i) + " .w_sn_value").addClass('sn_only');
					} else {
						//其他
						$(".w_i_" + (nb + i) + " .w_sn_value").addClass('sn_normal');
					}
					//還原已鎖定
					for (var s = 0; s < save_check.length; s++) {
						if (save_check[s] == key) {
							$('#' + key + " .w_sn_check").prop("checked", true);
							$('#' + key + " .w_sn_name").text(save_name[s]);
						}
					}
				}
				//顯示標題
				if (Object.keys(sn_list).length > 1) {
					$("#title_sn").removeClass('d-none');
				} else {
					$("#title_sn").addClass('d-none');
				}

				//Step4.更新工作站
				$("#workstation_name").text(main.allData.body.workdatation_name);
				$("#workdatation_sort").text('第' + main.allData.body.workdatation_sort + '站台');
				$("#workdatation_program_name").text(main.allData.body.workdatation_program_name);

				//Step5.自動位移
				var id = $(".border-1").attr("id");
				workstation.nb = 5;
				if ($(".sn_list").length > 0 && $("#w_focus_5").val() != "" && $("#w_focus_6").val() == "") {
					if ($('.w_i_6').hasClass('d-none')) {
						workstation.nb = 7;
					} else {
						workstation.nb = 6;
					}
				} else if ($('.w_i_6').hasClass('d-none')) {
					//Step6. 自動位移 A511 _new sn
					if ($(".sn_list").length > 0) {
						workstation.nb = 7;
					} else {
						workstation.nb = 5;
					}
				} else if (!$('.w_i_6').hasClass('d-none')) {
					//Step7. 自動位移 如果是A521 
					if ($(".sn_list").length > 0 && workstation.nb == 5) {
						workstation.nb = 7;
					} else {
						workstation.nb = 6;
					}
				}
				$("#after_sn_check").prop("checked", true);

				//更換Class
				$("#" + id).removeClass("border-1");
				$("#" + id).addClass("border-0");
				$("#w_focus_" + workstation.nb).addClass("border-1");
				$("#w_focus_" + workstation.nb).removeClass("border-0");

				//=======Step8.標籤=======
				//如果有[勾選]Part ON. 3*1
				if ($('#ph_mfg_p_no').is(":checked") && $("#m__ph_mfg_p_no .doc_c_value").val() != "") {
					var top_lb = $("#m__ph_mfg_p_no .doc_c_name").text();
					top_lb += $("#m__ph_mfg_p_no .doc_c_value").val();
					$("#barcode_sn_print #barcode_p_number").text(top_lb);
				} else {
					$("#barcode_sn_print #barcode_p_number").text("");
				}
				//如果有[勾選]Part ON. 3*2
				if ($('#ph_p_double_number').is(":checked") && $("#m__ph_p_double_number .doc_c_value").val() != "") {
					var top_lb = $("#m__ph_mfg_p_no .doc_c_name").text();
					top_lb += $("#m__ph_mfg_p_no .doc_c_value").val();
					$("#barcode_p_double_number").text(top_lb);
				} else {
					$("#barcode_p_double_number").text("");
				}
				//如果有[勾選]PN 6*10 產品名(號)
				if ($('#pn_big_model_check').is(":checked") && $("#m__pr_p_name .doc_c_value").val() != "") {
					var top_lb = $("#m__pr_p_name .doc_c_value").val();
					$("#barcode_sn_big_list .barcode_cumulative_model_name").text(top_lb);
				}
				//如果有[勾選]PN 6*10 產品名(號)
				if ($('#pn_cumulative_model_check').is(":checked") && $("#m__pr_p_name .doc_c_value").val() != "") {
					var top_lb = $("#m__pr_p_name .doc_c_value").val();
					$("#barcode_sn_all_list .barcode_cumulative_model_name").text(top_lb);
				}

				//是SN欄位則登記
				if ($('#w_focus_5').val() != "") {
					var barcode_sn = "";
					//3*1 sn_list有[勾選]
					$(".barcode_sn_print_list").remove();
					for (var i = $('.sn_list').length - 1; i >= 0; i--) {
						if ($('#' + $('.sn_list')[i].id + ' .w_sn_check').is(":checked") && $('#' + $('.sn_list')[i].id + ' .w_sn_value').val() != "") {
							//取得自訂SN
							barcode_sn = $('#' + $('.sn_list')[i].id + ' .w_sn_name').text().substr(0, 4) + ": ";
							barcode_sn += $('#' + $('.sn_list')[i].id + ' .w_sn_value').val();
							$('#barcode_sn_name').text(barcode_sn);
							workstation.create_barcode("barcode_sn_one", $('#' + $('.sn_list')[i].id + ' .w_sn_value').val(), "code39", 25);

							if (i > 0) {
								var barcode_sn_print = $('#barcode_sn_print').clone();
								barcode_sn_print[0].id = '';
								barcode_sn_print[0].className = 'barcode_sn_print_list';
								barcode_sn_print[0].style = "page-break-after:always";
								barcode_sn_print.insertAfter('#barcode_sn_print');

							} else if (!$('#ph_p_no_number').is(":checked")) {
								var barcode_sn_print = $('#barcode_sn_print').clone();
								barcode_sn_print[0].id = '';
								barcode_sn_print[0].style = "page-break-after:always";
								barcode_sn_print[0].className = 'barcode_sn_print_list';
								barcode_sn_print.insertAfter('#barcode_sn_print');
							}
						}
					}
					//取消Part no
					$('.barcode_sn_print_list #barcode_p_number').text("");
					if (!$('#ph_p_no_number').is(":checked")) {
						$('#barcode_sn_print #barcode_sn_name').text("S/N: " + $('#w_focus_5').val());
						workstation.create_barcode("barcode_sn_print  #barcode_sn_one", $('#w_focus_5').val(), "code39", 25);
					}

					//3*2 sn_list 有[勾選]
					var sn_list_nb = 0;
					var old_i = 0;
					for (var i = $('.sn_list').length - 1; i >= 0; i--) {
						if ($('#' + $('.sn_list')[i].id + ' .w_sn_check').is(":checked")) {
							sn_list_nb += 1;
							if (sn_list_nb == 2) {
								barcode_sn = $('#' + $('.sn_list')[old_i].id + ' .w_sn_name').text().substr(0, 4) + ": ";
								barcode_sn += $('#' + $('.sn_list')[old_i].id + ' .w_sn_value').val();
								$('#barcode_sn_double_name').text(barcode_sn);
								workstation.create_barcode("barcode_sn_double", $('#' + $('.sn_list')[old_i].id + ' .w_sn_value').val(), "code39", 25);

								barcode_sn = $('#' + $('.sn_list')[i].id + ' .w_sn_name').text().substr(0, 4) + ": ";
								barcode_sn += $('#' + $('.sn_list')[i].id + ' .w_sn_value').val();
								$('#barcode_sn_double_name2').text(barcode_sn);
								workstation.create_barcode("barcode_sn_double2", $('#' + $('.sn_list')[i].id + ' .w_sn_value').val(), "code39", 25);
								break;
							} else if (sn_list_nb == 1) {
								barcode_sn = $('#' + $('.sn_list')[i].id + ' .w_sn_name').text().substr(0, 4) + ": ";
								barcode_sn += $('#' + $('.sn_list')[i].id + ' .w_sn_value').val();
								$('#barcode_sn_double_name2').text(barcode_sn);
								workstation.create_barcode("barcode_sn_double2", $('#' + $('.sn_list')[i].id + ' .w_sn_value').val(), "code39", 25);
								old_i = i;

							}
						}
					}

					if (!$('#ph_p_double_no_number').is(":checked")) {
						$('#barcode_sn_double_name').text("S/N: " + $('#w_focus_5').val());
						workstation.create_barcode("barcode_sn_double", $('#w_focus_5').val(), "code39", 25);
					}

					//6*10 sn_list 有[勾選]
					sn_list_nb = 0;
					old_i = 0;
					$('#barcode_sn_big_name').text("");
					$('#barcode_sn_big_name_0').text("");
					$('#barcode_sn_big_name_1').text("");
					$('#barcode_sn_big_name_2').text("");
					$('#barcode_sn_big_value').empty();
					$('#barcode_sn_big_value_0').empty();
					$('#barcode_sn_big_value_1').empty();
					$('#barcode_sn_big_value_2').empty();
					for (var i = 0; i <= $('.sn_list').length - 1; i++) {
						//有勾選
						if ($('#' + $('.sn_list')[i].id + ' .w_sn_check').is(":checked")) {
							barcode_sn = $('#' + $('.sn_list')[i].id + ' .w_sn_name').text().substr(0, 4) + ": ";
							barcode_sn += $('#' + $('.sn_list')[i].id + ' .w_sn_value').val();
							$('#barcode_sn_big_name_' + sn_list_nb).text(barcode_sn);
							workstation.create_barcode("barcode_sn_big_value_" + sn_list_nb, $('#' + $('.sn_list')[i].id + ' .w_sn_value').val(), "code39", 25);
							sn_list_nb += 1;
						}
					}
					$('#barcode_sn_big_name').text($('#w_focus_5').val());
					workstation.create_barcode("barcode_sn_big_value", $('#w_focus_5').val(), "code39", 25);

					//外包裝 累計條碼
					if ($('#sn_cumulative_check').is(":checked")) {
						var check_same_sn = true;
						//排除重複
						if (workstation.sn_box_list.length != 0) {
							for (var e = 0; e < workstation.sn_box_list.length; e++) {
								if ($("#w_focus_5").val() == workstation.sn_box_list[e]) {
									check_same_sn = false;
								}
							}
						}

						if (check_same_sn) {
							workstation.sn_box_list.push($("#w_focus_5").val());
							workstation.sn_box_number += 1;
							$("#sn_cumulative_example input").val($("#w_focus_5").val());
							var sn_cumulative_example = $("#sn_cumulative_example").clone();
							sn_cumulative_example[0].className = "d-none sn_cumulative_list row p-1 m-0 border border-light rounded font-weight-bold";
							sn_cumulative_example[0].id = "";
							sn_cumulative_example.insertAfter("#sn_cumulative_example");
							$("#sn_cumulative_example input").val("複製樣本");

							//barcode 登記 外包裝累加
							var barcode_sn_list_ex = $("#barcode_sn_list_ex").clone();
							var barcode_sn_id = 'barcode_sn_list_' + $('.sn_cumulative_list').length;
							var barcode_sn_name = 'barcode_sn_name_' + $('.sn_cumulative_list').length;
							barcode_sn_list_ex[0].id = "";
							barcode_sn_list_ex[0].className = "mt-1 package_qty";
							barcode_sn_list_ex[0].children[0].id = barcode_sn_id;
							barcode_sn_list_ex[0].children[1].id = barcode_sn_name;
							barcode_sn_list_ex[0].children[1].innerText = $("#w_focus_5").val();
							barcode_sn_list_ex.insertBefore("#barcode_sn_list_ex");
							workstation.create_barcode(barcode_sn_id, $("#w_focus_5").val(), "code39", 18);

							$("#barcode_sn_qty").text($(".package_qty").length);
						}
					} else {
						//不勾選->清除Package
						$(".sn_cumulative_list").remove();
						$(".package_qty").remove();
						$("#barcode_sn_qty").text(0);
						workstation.sn_box_number = 0;
						workstation.sn_box_list = [];
					}
				}
				//=======Step9.New標籤=======
				if (main.allData.body.obj_label != null && $("#label_pr_id").text() != doc_list.m__ph_pr_id) {

					var obj_labels = main.allData.body.obj_label;
					$(".label_re").remove();
					$(".label_hr").remove();
					$("#label_pr_id").text(doc_list.m__ph_pr_id);
					$("#label_group").text("/Label For : " + obj_labels[0].label_set.ll_g_name);

					//每個標籤設定
					var ex_label_hr_text = "";
					obj_labels.forEach(function (x) {
						var ll_id = x.label_set.ll_id;
						var ex_label = $($("#ex_label_id").clone());
						ex_label.removeClass("d-none");
						ex_label.addClass("label_re");
						ex_label.find('#ex_label_op').attr('id', "id_" + ll_id + '_label_op');
						ex_label.find('#ex_label_cl').attr('id', "id_" + ll_id + '_label_cl');
						ex_label.find('#ex_label').attr('id', "id_" + ll_id + '_label');
						ex_label.find('.label_name').text(x.label_set.ll_name);
						ex_label.find('.label_auto').attr('id', "id_" + ll_id + '_label_auto');
						ex_label.attr('id', '');
						//取代括弧()分類
						let hr_s = x.label_set.ll_name.indexOf("(");
						let hr_e = x.label_set.ll_name.indexOf(")");
						var hr_text = x.label_set.ll_name.slice(hr_s, (hr_e + 1));
						if (hr_text != ex_label_hr_text) {
							var ex_label_hr = $("#ex_label_hr").clone();
							ex_label_hr.attr('id', '');
							ex_label_hr.addClass('label_hr');
							ex_label_hr.removeClass('d-none');
							ex_label_hr.text('－' + hr_text + '－');
							ex_label_hr.appendTo("#label_list");
							ex_label_hr_text = hr_text;
						}

						//有包裝設定?
						if (x.label_package.ll_o_p_type) {
							ex_label.find('.barcode_print_q').removeClass("d-none");
							ex_label.find('.barcode_package_q').removeClass("d-none");
							ex_label.find('.barcode_package_q input').val(x.label_package.ll_o_p_qty);

							ex_label.find('.barcode_label_q').removeClass("d-none");
							ex_label.find('.barcode_label_q input').val(x.label_package.ll_o_l_qty);

						}
						//標籤內有 任何 跟隨機制/自訂義?
						var front_from_sn = false;
						var front_from_fixed = false;
						var front_from_fixed_val = "";
						//自訂義
						var front_from_lc1 = false;
						var front_from_lc2 = false;
						var front_from_lc3 = false;
						var front_from_lc4 = false;
						var front_from_lc1_val = "";
						var front_from_lc2_val = "";
						var front_from_lc3_val = "";
						var front_from_lc4_val = "";
						x.label_block.forEach(function (y) {
							//固定
							if (y.ll_fo_content.ll_fd_f && !front_from_fixed) {
								front_from_fixed = (y.ll_fo_content.ll_fd_f == "fn.front_from_fixed");
								if (front_from_fixed) {
									ex_label.find('.from_fixed_def').text(y.ll_fo_content.ll_fd);
								}
							}
							if (y.ll_fo_content.ll_bfd_f && !front_from_fixed) {
								front_from_fixed = (y.ll_fo_content.ll_bfd_f == "fn.front_from_fixed");
								if (front_from_fixed) {
									ex_label.find('.from_fixed_def').text(y.ll_fo_content.ll_bfd);
								}
							}
							if (y.ll_fo_content.ll_bqfd_f && !front_from_fixed) {
								front_from_fixed = (y.ll_fo_content.ll_bqfd_f == "fn.front_from_fixed");
								if (front_from_fixed) {
									ex_label.find('.from_fixed_def').text(y.ll_fo_content.ll_bqfd);
								}
							}

							//浮動
							if (y.ll_fo_content.ll_fd_f && !front_from_sn) {
								front_from_sn = (y.ll_fo_content.ll_fd_f == "fn.front_from_sn");
							} else if (y.ll_fo_content.ll_bfd_f && !front_from_sn) {
								front_from_sn = (y.ll_fo_content.ll_bfd_f == "fn.front_from_sn");
							} else if (y.ll_fo_content.ll_bqfd_f && !front_from_sn) {
								front_from_sn = (y.ll_fo_content.ll_bqfd_f == "fn.front_from_sn");
							}

							//自訂義(1)
							if (y.ll_fo_content.ll_fd_f && !front_from_lc1 && (y.ll_fo_content.ll_fd_f == "lc.front_from_lc1")) {
								front_from_lc1 = true;
								ex_label.find('.label_lc1 textarea').attr("placeholder", y.ll_fo_content.ll_fd);
							} else if (y.ll_fo_content.ll_bfd_f && !front_from_lc1 && (y.ll_fo_content.ll_bfd_f == "lc.front_from_lc1")) {
								front_from_lc1 = true;
								ex_label.find('.label_lc1 textarea').attr("placeholder", y.ll_fo_content.ll_bfd);
							} else if (y.ll_fo_content.ll_bqfd_f && !front_from_lc1 && (y.ll_fo_content.ll_bqfd_f == "lc.front_from_lc1")) {
								front_from_lc1 = true;
								ex_label.find('.label_lc1 textarea').attr("placeholder", y.ll_fo_content.ll_bqfd);
							}
							//自訂義(2)
							if (y.ll_fo_content.ll_fd_f && !front_from_lc2 && (y.ll_fo_content.ll_fd_f == "lc.front_from_lc2")) {
								front_from_lc2 = true;
								ex_label.find('.label_lc2 textarea').attr("placeholder", y.ll_fo_content.ll_fd);
							} else if (y.ll_fo_content.ll_bfd_f && !front_from_lc2 && (y.ll_fo_content.ll_bfd_f == "lc.front_from_lc2")) {
								front_from_lc2 = true;
								ex_label.find('.label_lc2 textarea').attr("placeholder", y.ll_fo_content.ll_bfd);
							} else if (y.ll_fo_content.ll_bqfd_f && !front_from_lc2 && (y.ll_fo_content.ll_bqfd_f == "lc.front_from_lc2")) {
								front_from_lc2 = true;
								ex_label.find('.label_lc2 textarea').attr("placeholder", y.ll_fo_content.ll_bqfd);
							}
							//自訂義(3)
							if (y.ll_fo_content.ll_fd_f && !front_from_lc3 && (y.ll_fo_content.ll_fd_f == "lc.front_from_lc3")) {
								front_from_lc3 = true;
								ex_label.find('.label_lc3 textarea').attr("placeholder", y.ll_fo_content.ll_fd);
							} else if (y.ll_fo_content.ll_bfd_f && !front_from_lc3 && (y.ll_fo_content.ll_bfd_f == "lc.front_from_lc3")) {
								front_from_lc3 = true;
								ex_label.find('.label_lc3 textarea').attr("placeholder", y.ll_fo_content.ll_bfd);
							} else if (y.ll_fo_content.ll_bqfd_f && !front_from_lc3 && (y.ll_fo_content.ll_bqfd_f == "lc.front_from_lc3")) {
								front_from_lc3 = true;
								ex_label.find('.label_lc3 textarea').attr("placeholder", y.ll_fo_content.ll_bqfd);
							}
							//自訂義(4)
							if (y.ll_fo_content.ll_fd_f && !front_from_lc4 && (y.ll_fo_content.ll_fd_f == "lc.front_from_lc4")) {
								front_from_lc4 = true;
								ex_label.find('.label_lc4 textarea').attr("placeholder", y.ll_fo_content.ll_fd);
							} else if (y.ll_fo_content.ll_bfd_f && !front_from_lc4 && (y.ll_fo_content.ll_bfd_f == "lc.front_from_lc4")) {
								front_from_lc4 = true;
								ex_label.find('.label_lc4 textarea').attr("placeholder", y.ll_fo_content.ll_bfd);
							} else if (y.ll_fo_content.ll_bqfd_f && !front_from_lc4 && (y.ll_fo_content.ll_bqfd_f == "lc.front_from_lc4")) {
								front_from_lc4 = true;
								ex_label.find('.label_lc4 textarea').attr("placeholder", y.ll_fo_content.ll_bqfd);
							}


						});
						//顯示而外設定?
						//浮動
						if (front_from_sn) {
							ex_label.find('.front_from').removeClass("d-none");
						}
						//自訂義
						if (front_from_lc1) {
							ex_label.find('.label_lc1').removeClass("d-none");
						}
						if (front_from_lc2) {
							ex_label.find('.label_lc2').removeClass("d-none");
						}
						if (front_from_lc3) {
							ex_label.find('.label_lc3').removeClass("d-none");
						}
						if (front_from_lc4) {
							ex_label.find('.label_lc4').removeClass("d-none");
						}


						ex_label.appendTo("#label_list");
						//存入設定
						workstation.obj_label["id_" + ll_id + '_label_auto'] = x;
					});
					console.log(workstation.obj_label);

					//是否有存-上次標籤設定
					if (workstation.rber_pr_set.length > 0) {
						workstation.rber_pr_set.forEach(function (z) {
							if ($("#" + z.id) != null) {
								$("#" + z.id + " .label_auto ").attr("checked", true);
								$("#" + z.id + " .printer_c input").val(z.printer_c);
								$("#" + z.id + " .barcode_print_q input").val(z.barcode_print_q);
								$("#" + z.id + " .barcode_package_q input").val(z.barcode_package_q);
								$("#" + z.id + " .barcode_label_q input").val(z.barcode_label_q);
								//包裝?
								if (z.barcode_label_package != null) {
									$("#" + z.id + " .front_from").html(z.barcode_label_package);
									console.log(z.barcode_label_package);
								}

								//自定義類型?(label_lc1)
								if (z.label_lc1 != null) {
									$("#" + z.id + " .label_lc1 textarea").val(z.label_lc1);
								}
								//自定義類型?(label_lc2)
								if (z.label_lc2 != null) {
									$("#" + z.id + " .label_lc2 textarea").val(z.label_lc2);
								}
								//自定義類型?(label_lc3)
								if (z.label_lc3 != null) {
									$("#" + z.id + " .label_lc3 textarea").val(z.label_lc3);
								}
								//自定義類型?(label_lc4)
								if (z.label_lc4 != null) {
									$("#" + z.id + " .label_lc4 textarea").val(z.label_lc4);
								}
							}
						});
					}
				}
				//自動化勾選
				if ($('.label_auto').is(":checked")) {
					$('.label_auto').map(function () {
						if (this.id != "" && $("#" + this.id).is(":checked")) {
							var choose_id = this.id.replace("_auto", "");

							//確定有勾選且有(跟隨機制)Front_From
							if (!$("#" + choose_id + " .front_from").hasClass("d-none")) {
								//數量?
								var pq = parseInt($("#" + choose_id + " .barcode_package_q input").val());
								var from_sn_lh = $("#" + choose_id + " .front_from .from_sn").length;
								if (from_sn_lh <= pq) {
									var f_f_l = $("#" + choose_id + " .from_sn").map((_, el) => el.innerHTML).get();
									//不能重複+數量不能超過設定
									if (f_f_l.indexOf($('#w_focus_5').val()) < 0 && from_sn_lh < pq) {
										//固定
										var f_f_fixed = $($("#" + choose_id + " .from_fixed_def").clone());
										f_f_fixed.removeClass("d-none");
										f_f_fixed.removeClass("from_fixed_def");
										f_f_fixed.addClass("from_fixed");
										f_f_fixed.appendTo("#" + choose_id + " .front_from");
										//浮動
										var f_f_sn = $($("#" + choose_id + " .from_sn_def").clone());
										f_f_sn.removeClass("d-none");
										f_f_sn.removeClass("from_sn_def");
										f_f_sn.addClass("from_sn");
										f_f_sn.text($('#w_focus_5').val());
										f_f_sn.appendTo("#" + choose_id + " .front_from");
									}

								} else if ($("#" + choose_id + " .from_sn").length == pq) {
									//如果是有特殊設定(Front_From_SN)->但是沒外包裝
									$("#" + choose_id + " .from_sn").text($('#w_focus_5').val());
								}

							}
						}
					});
				}

				//Step Last.如果:存檔後檢查
				if (workstation.barcode_save) {
					workstation.barcode_save = false;
					//=======.New標籤=======
					if ($('.label_auto').is(":checked")) {
						var BC011_send = false;
						workstation.force_label = false;
						$('.label_auto').map(function () {
							if (this.id != "" && $("#" + this.id).is(":checked")) {
								var choose_id = this.id.replace("_auto", "");
								//包裝-確定有勾選且有(跟隨機制)Front_From
								if (!$("#" + choose_id + " .front_from").hasClass("d-none")) {
									//數量?
									var pq = parseInt($("#" + choose_id + " .barcode_package_q input").val());
									if ($("#" + choose_id + " .front_from .from_sn").length >= pq) {
										BC011_send = true;
									}
								} else {
									//一般
									BC011_send = true;
								}
							}
						});
						//有滿足條件即刻發送
						if (BC011_send) {
							this.temp_w_focus_5 = $('#w_focus_5').val();
							$("#BC011").trigger("click");
						} else {

						}
					}
					//清除
					//Step Last.基本清除
					//$('#w_focus_3').val("");
					$('#w_focus_4').val("");
					$('#w_focus_5').val("");
					$('#w_focus_6').val("");
					//勾選清除?
					if ($('#only_check').is(":checked")) {
						$(".sn_list .sn_normal").val("");
					} else {
						$(".sn_list .w_sn_value").val("");
					}

					//Step Last.更換Class
					var id = $(".border-1").attr("id");
					workstation.nb = 5;
					$("#" + id).removeClass("border-1");
					$("#" + id).addClass("border-0");
					$("#w_focus_" + workstation.nb).addClass("border-1");
					$("#w_focus_" + workstation.nb).removeClass("border-0");
				}
			},
		},
		//移除監聽事件
		beforeDestroy() {
			console.log("workstation.html(beforeDestroy)");
			$(document).off("click", "#barcode_open");
			$(document).off("click", "#doc_open");
			$(document).off("click", "#fix_open");
			$(document).off("click", ".barcode_action");
			$(document).off("click", ".pn__cl");
			$(document).off("click", ".pn__op");
			$(document).off("input", "#fix_i_textarea_zzzz");
			$(document).off("keydown");
			$(document).off("keyup");

			t_alert.sound_warning = false;
		}
	});
</script>